<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alat Ganti Komputer</title>
    <link rel="stylesheet" href="style.css">
</head>

<!-- LOADER OVERLAY -->
<div id="loadingOverlay">
    <span class="loader"></span>
</div>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>üñ•Ô∏è Dashboard Alat Ganti Komputer</h1>
                <p class="subtitle">Sistem Permohonan Alat Ganti Komputer</p>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-inner">
                <button class="burger-btn" aria-label="Toggle menu">‚ò∞</button>
                <ul class="nav-menu">
                    <li><a href="#dashboard" class="nav-link active">Dashboard</a></li>
                    <li><a href="#requests" class="nav-link">Permohonan User</a></li>
                    <li><a href="#equipment-list" class="nav-link">Senarai Alat Ganti</a></li>
                    <li><a href="#equipment-listPC" class="nav-link">Senarai Komputer</a></li>
                    <li><a href="#budget" class="nav-link">LAPORAN STOK</a></li>
                    <li><a href="#contohkira" class="nav-link">Stok</a></li>
                    <li><a href="#adminSection" class="nav-link">Settings</a></li>

                </ul>
                <!-- Burger list inside nav-inner for proper positioning -->
                <ul class="burger-list" id="burgerList" aria-hidden="true">
                    <li><a href="#dashboard" class="burger-link">Dashboard</a></li>
                    <li><a href="#requests" class="burger-link">Permohonan User</a></li>
                    <li><a href="#equipment-list" class="burger-link">Senarai Alat Ganti</a></li>
                    <li><a href="#equipment-listPC" class="burger-link">Senarai Komputer</a></li>
                    <li><a href="#budget" class="burger-link">LAPORAN STOK</a></li>
                    <li><a href="#contohkira" class="burger-link">Stok</a></li>
                    <li><a href="#adminSection" class="burger-link">Settings</a></li>
                    <li><a href="#" id="logoutBtn" class="burger-link">Logout</a></li>
                </ul>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="section">
                <h2>DASHBOARD PERMOHONAN USER</h2> <!-- Dashboard yang Connected ke Form Permohonan ---->

                <!-- Ringkasan Statistik -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #8e44ad;">üìù</div>
                        <div class="stat-content">
                            <h3>Permohonan Baru</h3>
                            <p class="stat-value" id="reqNew">0</p>
                            <span class="stat-label">Menunggu tindakan</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #3498db;">‚öôÔ∏è</div>
                        <div class="stat-content">
                            <h3>Dalam Proses</h3>
                            <p class="stat-value" id="reqInProgress">0</p>
                            <span class="stat-label">Sedang diproses</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #2ecc71;">‚úÖ</div>
                        <div class="stat-content">
                            <h3>Selesai</h3>
                            <p class="stat-value" id="reqDone">0</p>
                            <span class="stat-label">Telah selesai</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #e3ac7c;">‚ùå</div>
                        <div class="stat-content">
                            <h3>Ditolak</h3>
                            <p class="stat-value" id="reqRejected">0</p>
                            <span class="stat-label">Permohonan ditolak</span>
                        </div>
                    </div>
                </div> <!-- End statistik ringkasan -->



                <h2>Senarai Komputer</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #9b59b6;">üñ•Ô∏è</div>
                        <div class="stat-content">
                            <h3>Total Komputer</h3>
                            <p class="stat-value" id="totalComputers">0</p>
                            <span class="stat-label">Jumlah keseluruhan unit</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #3498db;">üíª</div>
                        <div class="stat-content">
                            <h3>Desktop</h3>
                            <p class="stat-value" id="totalDesktops">0</p>
                            <span class="stat-label">Unit Desktop</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #1abc9c;">üìì</div>
                        <div class="stat-content">
                            <h3>Laptop</h3>
                            <p class="stat-value" id="totalLaptops">0</p>
                            <span class="stat-label">Unit Laptop</span>
                        </div>
                    </div>
                </div>

                <h2>Senarai Alat Ganti</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #e67e22;">üîß</div>
                        <div class="stat-content">
                            <h3>Jumlah Keseluruhan</h3>
                            <p class="stat-value" id="totalEquipment">0</p>
                            <span class="stat-label">Total Unit Alat Ganti</span>
                        </div>
                    </div>
                </div>


            </section>

            <!----------------------------------------------------------------------------- -->
            <!-------------------- BAHAGIAN PERMOHONAN ALAT GANTI (USER) --------------------->
            <!------------------------AKAN DIPAPARKAN PADA DASHBOARD PERMOHONAN USER--------->
            <!----------------------------------------------------------------------------- -->
            <section id="requests" class="section">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                    <div>
                        <h2>üì® Permohonan Alat Ganti (User)</h2>
                        <p style="color:#7f8c8d;margin-bottom:0;">Senarai permohonan daripada user. Admin boleh tambah /
                            edit / padam.</p>
                    </div>
                    <div class="action-buttons-top">
                        <button class="btn btn-secondary" id="generateReportBtn">üñ®Ô∏è Laporan (A4)</button>
                        <button class="btn btn-primary" id="openRequestForm">‚ûï Tambah Permohonan</button>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="inventory-table" id="requestsTable">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Nama Pengadu</th>
                                <th>Model Komputer</th> <!--Cth : Desktop / Laptop-->
                                <th>Jenama Komputer</th> <!--Cth : Dell Optiplex 9020-->
                                <th>No Siri</th>
                                <th>Item Diminta</th> <!--Cth : Motherboard-->
                                <th>No Siri Alat Ganti</th>
                                <th>Status</th> <!--Auto : Baru-->
                                <th>Nama Juruteknik</th>
                                <th>Catatan</th>
                                <th>Tarikh Memohon</th>
                                <th>Tarikh Selesai</th>
                                <th>Tindakan</th>
                            </tr>
                        </thead>
                        <tbody id="requestsTableBody">
                            <tr class="empty-row">
                                <td colspan="10" class="text-center">Belum ada permohonan.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Modal Form Permohonan -->
            <div id="requestModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="requestModalTitle">‚ûï Tambah Permohonan</h2>
                        <button class="modal-close" id="closeRequestModal">&times;</button>
                    </div>
                    <form id="addRequestForm" class="form-container">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="reqCust">Nama Pengadu</label> <!--// reqRequester gantikan kepada reqCUst-->
                                <input type="text" id="reqCust" required placeholder="Nama pengadu">
                                <!-- nama pengadu-->
                            </div>
                            <div class="form-group">
                                <label for="reqModel">Model Komputer</label> <!--// letakkan reqModel Model Komputer-->
                                <select id="reqModel">
                                    <option value="">-- Pilih Model --</option>
                                    <option value="Desktop">Desktop</option>
                                    <option value="Laptop">Laptop</option>
                                    <option value="Bahan Pakai Habis">Bahan Pakai Habis</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="reqJenama">Jenama Komputer</label> <!--// reqJenama-->
                                <select id="reqJenama">
                                    <option value="">-- Pilih Jenama --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="reqNoSiri">No Siri Komputer</label> <!--// reqNoSiri-->
                                <input type="text" id="reqNoSiri" placeholder="Masukkan Nombor Siri Komputer">
                            </div>
                            <div class="form-group">
                                <label for="reqRequestItem">Alat Ganti Dipohon</label>
                                <select id="reqRequestItem">
                                    <option value="">-- Pilih Item --</option>
                                </select>
                            </div>
                            <div class="form-group" id="groupSiriGanti">
                                <label for="reqSiriGanti">No Siri Alat Ganti</label> <!--// reqNoSiri-->
                                <input type="text" id="reqSiriGanti" placeholder="Masukkan No Siri Alat Ganti">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group" style="display:block;" id="groupStatus">
                                <label for="reqStatus">Status</label>
                                <select id="reqStatus">
                                    <option value="Baru">Baru</option>
                                    <option value="Dalam Proses">Dalam Proses</option>
                                    <option value="Selesai">Selesai</option>
                                    <option value="Ditolak">Ditolak</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="reqJuruteknik">Nama Juruteknik</label>
                                <select id="reqJuruteknik">
                                    <option value="">-- Pilih Juruteknik --</option>
                                    <option value="Ikmal">Ikmal</option>
                                    <option value="Bala">Bala</option>
                                    <option value="Cici">Cici</option>
                                </select>
                            </div>
                            <div class="form-group" id="groupDateEnd">
                                <label for="reqDateEnd">Tarikh Selesai</label>
                                <!--// reqDateEnd-muncul selesai butang selesai dipilih auto update date-->
                                <input type="datetime-local" id="reqDateEnd" placeholder="Selesai">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="reqcatat">Catatan</label>
                            <textarea id="reqcatat" rows="7" placeholder="Catatan (opsional)"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" id="cancelRequestBtn">Batal</button>
                            <button type="submit" class="btn btn-primary">üíæ Simpan Permohonan</button>
                        </div>
                    </form>
                </div>
            </div>


            <!------------------------------------------------------------------------------>
            <!-------------------------BAHAGIAN SENARAI ALAT GANTI ------------------------>
            <!------------------------------------------------------------------------------>
            <!-- Equipment List Section -->
            <section id="equipment-list" class="section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div>
                        <h2>üì¶ Senarai Alat Ganti Table Dan Kuantiti </h2>
                        <p style="color: #7f8c8d; margin-bottom: 1;">Senarai item alat Ganti komputer .</p>
                    </div>
                    <button class="btn btn-primary" id="openAddEquipmentForm">‚ûï Tambah senarai Baru Alat Ganti</button>
                </div>

                <!--table list area-->
                <div class="table-responsive">
                    <table class="equipment-table" id="equipmentTable"> <!--equipmentTable-->
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Model Komputer</th>
                                <th>Alat Ganti Dipohon</th>
                                <th>Nama Model</th> <!--Butang-->
                                <th>Kuantiti Sebenar</th>
                                <th>Harga Seunit</th>
                                <th>Total Harga</th>
                                <th>Status/catat</th>
                                <th>Tindakan</th>
                            </tr>
                        </thead>
                        <tbody id="equipmentTableBody">
                            <tr class="empty-row">
                                <td colspan="7" class="text-center">Belum ada data peralatan. Tambahkan peralatan baru
                                    untuk memulai.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="margin-top:15px; display:flex; gap:10px; align-items:center;">
                    <input type="file" id="importEquipmentFile" accept=".csv,.xlsx" />
                    <button class="btn btn-secondary" id="importEquipmentBtn">üì§ Import (CSV/XLSX)</button>
                    <small style="color:#7f8c8d;">Format: Model Komputer, Alat Ganti Dipohon, Kuantiti Sebenar </small>
                </div>
            </section>

            <!-- Modal Form Tambah Peralatan dalam senarai alat ganti -->
            <div id="equipmentModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="modalTitle">‚ûï Tambah Alat Ganti Form</h2>
                        <button class="modal-close" id="closeModalBtn">&times;</button>
                    </div>
                    <form id="addEquipmentForm" class="form-container">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="komp11">Pilih Model <span class="required">*</span></label>
                                <select id="komp11">
                                    <option value="">-- Pilih Model --</option>
                                    <option value="DESKTOP">DESKTOP</option>
                                    <option value="LAPTOP">LAPTOP</option>
                                    <option value="BAHAN PAKAI HABIS">BAHAN PAKAI HABIS</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="NamaPeralatan">Nama Alat Ganti <span class="required">*</span></label>
                                <!--equipmentName ganti kepada NamaPeralatan-->
                                <input type="text" id="NamaPeralatan" required placeholder="Contoh: Motherboard">
                            </div>
                            <div class="form-group"> <!--equipmentModel ganti kepada NamaModel  -->
                                <label for="NamaModel">Nama Model</label>
                                <input type="text" id="NamaModel" placeholder="Contoh: 860 EVO">
                            </div>
                        </div>

                        <div class="form-divider1">
                            <span>KUANTITI DAN HARGA</span>
                        </div>

                        <div class="form-row">
                            <div class="form-group"> <!--equipmentQuantity ganti kepada Quantity -->
                                <label for="EQuantity">Kuantiti</label>
                                <input type="number" id="EQuantity" min="1" value="1">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group"> <!--equipmentQuantity ganti kepada Quantity -->
                                <label for="EHargaUnit">Harga Seunit (RM)</label>
                                <input type="number" id="EHargaUnit" min="0" value="0" step="0.01">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group"> <!--equipmentQuantity ganti kepada Quantity -->
                                <label for="ETotalRM">Total Harga AutoSum (RM)</label>
                                <input type="number" id="ETotalRM" min="0" value="0" step="0.01" readonly
                                    style="background-color: #f8f9fa;">
                            </div>
                        </div>


                        <div class="form-row">
                            <div class="form-group"> <!--equipmentNotes ganti kepada Catatan1 -->
                                <label for="CatitAlatGanti">Catatan/Keterangan</label>
                                <textarea id="CatitAlatGanti" rows="3"
                                    placeholder="Catatan tambahan tentang peralatan ini"></textarea>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-primary">üíæ Simpan Peralatan</button>
                            <button type="button" class="btn btn-secondary" id="cancelModalBtn">Batal</button>
                        </div>
                    </form>
                </div>
            </div>






            <!------------------------------------------------------------------------------>
            <!-------------------------BAHAGIAN SENARAI KOMPUTER / DESKTOP /Laptop------------------------------->
            <!-- Equipment List Section -->
            <section id="equipment-listPC" class="section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div>
                        <h2>üì¶ Senarai Komputer Desktop/Laptop/Alat Pakai Habis </h2>
                        <p style="color: #7f8c8d; margin-bottom: 1;">Senarai item alat Ganti komputer .</p>
                    </div>
                    <button class="btn btn-primary" id="openAddComputerForm">‚ûï Tambah Komputer Baru</button>
                </div>

                <!--table list area-->
                <div class="table-responsive">
                    <table class="equipment-table" id="computerTable"> <!--equipmentTable renamed to computerTable-->
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Model Komputer</th>
                                <th>Jenama & Model</th>
                                <th>Tindakan</th>
                            </tr>
                        </thead>
                        <tbody id="computerTableBody">
                            <tr class="empty-row">
                                <td colspan="4" class="text-center">Belum ada data komputer. Tambahkan komputer baru
                                    untuk memulai.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="margin-top:15px; display:flex; gap:10px; align-items:center;">
                    <input type="file" id="importComputerFile" accept=".csv,.xlsx" />
                    <button class="btn btn-secondary" id="importComputerBtn">üì§ Import (CSV/XLSX)</button>
                    <small style="color:#7f8c8d;">Format: Model Komputer, Jenama & Model</small>
                </div>
            </section>

            <!-- Modal Form Tambah Peralatan dalam senarai alat ganti -->
            <div id="computerModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="computerModalTitle">‚ûï Tambah Komputer Baru</h2>
                        <button class="modal-close" id="closeComputerModalBtn">&times;</button>
                    </div>
                    <form id="addComputerForm" class="form-container">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="komp2">Pilih Model <span class="required">*</span></label>
                                <select id="komp2" required>
                                    <option value="">-- Pilih Model --</option>
                                    <option value="Desktop">DESKTOP</option>
                                    <option value="Laptop">LAPTOP</option>
                                    <option value="Bahan Pakai Habis">BAHAN PAKAI HABIS</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="NamaPC">Jenama & Model <span class="required">*</span></label>
                                <input type="text" id="NamaPC" required placeholder="Contoh: Dell Optiplex 9020">
                            </div>
                        </div>

                        <div class="modal-footer">
                            <button type="submit" class="btn btn-primary">üíæ Simpan Komputer</button>
                            <button type="button" class="btn btn-secondary" id="cancelComputerModalBtn">Batal</button>
                        </div>
                    </form>
                </div>
            </div>









            <!------------------------------------------------------------------------------------------------------------------------->

            <!-- ContohKira -->
            <section id="contohkira" class="section">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                    <div>
                        <h2>üì® Dashboard Stok</h2>
                        <p style="color:#7f8c8d;margin-bottom:0;">Senarai stok.</p>
                    </div>
                    <button class="btn btn-primary" id="openRequestForm1">‚ûï Tambah stok</button>
                </div>
                <div>
                    <h3>Jumlah Keseluruhan</h3>
                    <p id="jumlahKeseluruhan">0</p>
                </div>


                <!-- TABLE -->
                <div class="" table-responsive">
                    <table class="inventory-table" id="Contohkira">
                        <thead>
                            <tr>
                                <th>Item</th>
                                <th>Jumlah</th>
                                <th>Tindakan</th>
                            </tr>
                        </thead>
                        <tbody id="stokTable">
                            <tr class="empty-row">
                                <td colspan="2" class="text-center">Tiada data stok.</td>
                            </tr>
                        </tbody>

                        </tbody>
                    </table>
                </div>
    </div>
    </section>

    <div id="stokForm" class="modal">
        <div class="modal-content">

            <div class="modal-header">
                <h2>‚ûï Tambah Stok</h2>
                <button class="modal-close" id="closeRequestModal1">&times;</button>
            </div>

            <form id="tambahstok" class="form-container">
                <div class="form-group">
                    <label for="item">Nama Item</label>
                    <input type="text" id="item" required placeholder="Nama Item">
                </div>

                <div class="form-group">
                    <label for="kuantiti">Kuantiti</label>
                    <input type="number" id="kuantiti" required placeholder="Kuantiti" min="1">
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="cancelRequestBtn1">Batal</button>
                    <button type="submit" class="btn btn-primary">üíæ Simpan stok</button>
                </div>
            </form>

        </div>
    </div>












    <!-- Laporan Stok Section -->
    <section id="budget" class="section">
        <!-- Modal Preview Laporan -->
        <div id="previewReportModal" class="modal">
            <div class="modal-content" style="width: 90%; max-width: 1200px; overflow-y: auto; max-height: 90vh;">
                <div class="modal-header">
                    <h2>üìä Preview Laporan Stok</h2>
                    <button class="modal-close" id="closePreviewModal">&times;</button>
                </div>
                <div class="modal-body" id="previewReportBody">
                    <!-- Laporan akan dijana di sini -->
                </div>
                <div class="modal-footer" style="text-align: right;">
                    <button class="btn btn-secondary" id="closePreviewBtn">Tutup</button>
                    <button class="btn btn-primary" id="printPreviewBtn">üñ®Ô∏è Cetak Laporan</button>
                </div>
            </div>
        </div>

        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
            <div>
                <h2>üìä LAPORAN STOK</h2>
                <p style="color:#7f8c8d;margin-bottom:0;">Laporan penggunaan dan baki stok alat ganti.</p>
            </div>
            <div style="display:flex;gap:10px;">
                <button class="btn btn-secondary" id="printStockReportBtn">üñ®Ô∏è Cetak Laporan</button>
                <button class="btn btn-primary" id="refreshStockReportBtn">üîÑ Jana Laporan</button>
            </div>
        </div>

        <!-- Summary Cards -->
        <div id="stockSummaryCards"
            style="display:none;margin-bottom:25px;display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;">
            <div class="stat-card" style="background:linear-gradient(135deg,#667eea 0%,#6e4b91 100%);">
                <div class="stat-icon">üì¶</div>
                <div class="stat-info">
                    <div class="stat-label1">Jumlah Item</div>
                    <div class="stat-value-laporan" id="totalItemsCount">0</div>
                </div>
            </div>
            <div class="stat-card" style="background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);">
                <div class="stat-icon">‚ö†Ô∏è</div>
                <div class="stat-info">
                    <div class="stat-label1">Stok Kritikal (&gt;80%)</div>
                    <div class="stat-value-laporan" id="criticalStockCount">0</div>
                </div>
            </div>
            <div class="stat-card" style="background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%);">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-info">
                    <div class="stat-label1">Stok Mencukupi</div>
                    <div class="stat-value-laporan" id="healthyStockCount">0</div>
                </div>
            </div>
        </div>

        <div class="table-responsive">
            <table class="inventory-table" id="stockReportTable">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Model Komputer</th>
                        <th>Alat Ganti</th>
                        <th>Jumlah Stok</th>
                        <th>Penggunaan</th>
                        <th>Baki</th>
                        <th>Peratus Penggunaan</th>
                    </tr>
                </thead>
                <tbody id="stockReportBody">
                    <tr class="empty-row">
                        <td colspan="7" class="text-center">Tiada data laporan. Klik "Jana Laporan" untuk menjana.</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- Timeout Reminder Popup -->
    <div id="timeoutReminder" class="timeout-reminder">
        ‚ö†Ô∏è Anda akan logout dalam 1 minit kerana tiada aktiviti!
        <button id="stayLoggedIn" class="btn-stay">Terus Login</button>
    </div>
    <!-- Confirm Logout Popup -->
    <div id="confirmLogout" class="confirm-logout">
        <p>‚ö†Ô∏è Anda pasti mahu logout?</p>
        <div class="confirm-buttons">
            <button id="cancelLogout" class="btn-cancel">Batal</button>
            <button id="confirmLogoutBtn" class="btn-confirm">Logout</button>
        </div>
    </div>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2026 Dashboard Alat Ganti Komputer | Sistem Pengurusan Inventori Dan Kewangan</p>
    </footer>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="confirmationModal" class="modal">
        <div class="modal-content modal-warning">
            <div class="modal-header">
                <h2>‚ö†Ô∏è Pengesahan Hapus</h2>
                <button class="modal-close" onclick="closeConfirmationModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmationMessage">Adakah anda pasti mahu menghapus item ini?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="confirmDeleteBtn">Ya, Hapus</button>
                <button class="btn btn-secondary" onclick="closeConfirmationModal()">Batal</button>
            </div>
        </div>
    </div>

    <!---admin page-->
    <section id="adminSection" class="section admin-section">
        <h2>üîê Pengurusan Pengguna</h2>

        <!-- FORM ADD USER -->
        <div class="admin-card">
            <h3>‚ûï Tambah Pengguna</h3>
            <form id="addUserForm">
                <input type="text" id="name" placeholder="Nama" required>
                <input type="email" id="email" placeholder="Email / ID" required>

                <select id="role" required>
                    <option value="">Pilih Role</option>
                    <option value="admin">Admin</option>
                    <option value="user">User</option>
                </select>

                <input type="password" id="password" placeholder="Kata Laluan" required>

                <button type="submit">Tambah</button>
            </form>
        </div>

        <!-- TABLE -->
        <div class="admin-card">
            <h3>üìã Senarai Pengguna</h3>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>Nama</th>
                        <th>Email</th>
                        <th>Role</th>
                        <th>Tindakan</th>
                    </tr>
                </thead>
                <tbody id="userTable"></tbody>
            </table>
        </div>
    </section>


    <!------BAHAGIAN LAPORAN-->

    <!-- Modal for Editable Report Preview dalam permhonan user-->
    <div id="reportPreviewModal" class="modal">
        <div class="modal-content report-preview-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2>üõ†Ô∏è Edit & Pratonton Laporan</h2>
                <button class="modal-close" id="closeReportPreview">&times;</button>
            </div>

            <div class="report-ribbon">
                <div class="ribbon-tabs">
                    <button class="ribbon-tab active" onclick="switchRibbonTab('tab-home')">Utama</button>
                    <button class="ribbon-tab" onclick="switchRibbonTab('tab-insert')">Sisipan</button>
                    <button class="ribbon-tab" onclick="switchRibbonTab('tab-layout')">Tata Letak</button>
                    <div class="ribbon-actions-right">
                        <button class="btn btn-secondary btn-small" id="saveReportSettingsBtn">üíæ Simpan
                            Setting</button>
                        <button class="btn btn-primary btn-small" id="confirmPrintBtn">üñ®Ô∏è Cetak</button>
                    </div>
                </div>

                <div class="ribbon-content">
                    <!-- Home Tab -->
                    <div id="tab-home" class="ribbon-panel active">
                        <div class="toolbar-group">
                            <span class="toolbar-label">Font</span>
                            <select id="fontFamilySelect" class="toolbar-select"
                                onchange="formatDoc('fontName', this.value)">
                                <option value="Inter, sans-serif">Default (Inter)</option>
                                <option value="Arial, sans-serif">Arial</option>
                                <option value="'Times New Roman', serif">Times New Roman</option>
                                <option value="'Courier New', monospace">Courier New</option>
                                <option value="Georgia, serif">Georgia</option>
                            </select>
                            <button class="btn btn-small btn-secondary tool-btn" id="decreaseFontSize"
                                title="Kecilkan">-</button>
                            <input type="number" id="fontSizeInput" class="toolbar-input" value="10" min="6" max="100"
                                title="Saiz Font">
                            <button class="btn btn-small btn-secondary tool-btn" id="increaseFontSize"
                                title="Besarkan">+</button>
                        </div>
                        <div class="toolbar-divider"></div>
                        <div class="toolbar-group">
                            <span class="toolbar-label">Gaya</span>
                            <button class="btn btn-small btn-secondary tool-btn" onclick="formatDoc('bold')"
                                title="Tebal"><b>B</b></button>
                            <button class="btn btn-small btn-secondary tool-btn" onclick="formatDoc('italic')"
                                title="Condong"><i>I</i></button>
                            <button class="btn btn-small btn-secondary tool-btn" onclick="formatDoc('underline')"
                                title="Garis"><u>U</u></button>
                            <input type="color" id="foreColorPicker" onchange="formatDoc('foreColor', this.value)"
                                title="Warna">
                        </div>
                        <div class="toolbar-divider"></div>
                        <div class="toolbar-group">
                            <span class="toolbar-label">Paragraph</span>
                            <button class="btn btn-small btn-secondary tool-btn" onclick="formatDoc('justifyLeft')"
                                title="Kiri">Â∑¶</button>
                            <button class="btn btn-small btn-secondary tool-btn" onclick="formatDoc('justifyCenter')"
                                title="Tengah">‰∏≠</button>
                            <button class="btn btn-small btn-secondary tool-btn" onclick="formatDoc('justifyRight')"
                                title="Kanan">Âè≥</button>
                            <button class="btn btn-small btn-secondary tool-btn" onclick="formatDoc('justifyFull')"
                                title="Penuh">‚â°</button>
                        </div>
                    </div>

                    <!-- Insert Tab -->
                    <div id="tab-insert" class="ribbon-panel">
                        <div class="toolbar-group">
                            <span class="toolbar-label">Media</span>
                            <label for="reportLogoInput" class="btn btn-small btn-secondary">üñºÔ∏è Ambil Logo</label>
                            <input type="file" id="reportLogoInput" accept="image/*" style="display:none;">
                        </div>
                        <div class="toolbar-divider"></div>
                        <div class="toolbar-group">
                            <span class="toolbar-label">Saiz Logo</span>
                            <input type="range" id="logoWidthSlider" min="50" max="500" value="150"
                                style="width:150px;">
                            <span id="logoWidthValue" style="font-size:11px;">150px</span>
                        </div>
                    </div>

                    <!-- Layout Tab -->
                    <div id="tab-layout" class="ribbon-panel">
                        <div class="toolbar-group">
                            <span class="toolbar-label">Jarak Barisan (Line Height)</span>
                            <select id="lineHeightSelect" class="toolbar-select"
                                onchange="updateLineHeight(this.value)">
                                <option value="1">Sempit (1.0)</option>
                                <option value="1.2" selected>Normal (1.2)</option>
                                <option value="1.5">Sederhana (1.5)</option>
                                <option value="2">Luas (2.0)</option>
                            </select>
                        </div>
                        <div class="toolbar-divider"></div>
                        <div class="toolbar-group">
                            <span class="toolbar-label">Transform</span>
                            <button class="btn btn-small btn-secondary" onclick="transformText('uppercase')">HURUF
                                BESAR</button>
                            <button class="btn btn-small btn-secondary" onclick="transformText('lowercase')">huruf
                                kecil</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="reportEditableArea" contenteditable="true" class="report-editable-container">
                <!-- Report content will be injected here -->
            </div>

            <div class="modal-footer">
                <p style="font-size: 0.85rem; color: #666;">üí° Anda boleh klik pada tulisan di atas untuk mengedit
                    kandungan sebelum print.</p>
                <button type="button" class="btn btn-secondary" id="cancelReportPreview">Batal</button>
            </div>
        </div>




        <script src="script.js"></script>
        <!-- SheetJS for .xlsx import -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</body>

</html>